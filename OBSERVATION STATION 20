#WEATHER OBSERVATION STATION 20
#LANGUAGE: ORACLE

SELECT 
    ROUND(MEDIAN(LAT_N), 4) AS MEDIAN_LAT_N
FROM STATION;

#LANGUAGE: MYSQL
WITH Ordered AS (
  SELECT LAT_N, 
         ROW_NUMBER() OVER (ORDER BY LAT_N) AS rn,
         COUNT(*) OVER () AS cnt
  FROM STATION
)
SELECT 
    ROUND(AVG(LAT_N), 4) AS MEDIAN_LAT_N
FROM Ordered
WHERE rn IN (FLOOR((cnt + 1) / 2), CEIL((cnt + 1) / 2));
